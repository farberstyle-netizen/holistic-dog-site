<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Account | HTDA</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        .signup-container {
            max-width: 700px;
            margin: 3rem auto;
            background: white;
            padding: 3rem;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 4px solid var(--primary-maroon);
        }
        .form-title {
            text-align: center;
            color: var(--primary-maroon);
            margin-bottom: 1rem;
        }
        .form-subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 2rem;
        }
        .qualified-badge {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 2rem;
            border-left: 4px solid #2e7d32;
            text-align: center;
            font-weight: 600;
        }
        .error-box {
            background: #ffebee;
            color: #c62828;
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1.5rem;
            border-left: 4px solid #c62828;
            display: none;
        }
        .section-header {
            color: var(--primary-maroon);
            font-size: 1.3rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-gold);
        }
        .form-footer-link {
            text-align: center;
            margin-top: 1.5rem;
        }
        .form-footer-link a {
            color: var(--accent-gold);
            font-weight: 600;
        }
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        @media (max-width: 600px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="nav-container">
            <a href="index.html" class="logo">Holistic Therapy Dog<br>Association</a>
            <nav>
                <ul id="nav-links"></ul>
            </nav>
            <div class="nav-account" id="nav-account-links"></div>
        </div>
    </header>

    <div class="signup-container">
        <h1 class="form-title">Create Your Account</h1>
        <p class="form-subtitle">Step 2 of 3: Set up your account to continue the certification process.</p>
        
        <div id="qualified-badge" class="qualified-badge" style="display: none;">
            âœ… Congratulations! You've qualified for certification. Create your account below to continue.
        </div>
        
        <div id="error-box" class="error-box"></div>
        
        <form id="signupForm">
            <h3 class="section-header">Account Information</h3>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="first_name">First Name</label>
                    <input type="text" id="first_name" name="first_name" required>
                </div>
                <div class="form-group">
                    <label for="last_name">Last Name</label>
                    <input type="text" id="last_name" name="last_name" required>
                </div>
            </div>

            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" required>
            </div>

            <div class="form-grid">
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" minlength="8" required>
                    <small style="color: #666;">Minimum 8 characters</small>
                </div>
                <div class="form-group">
                    <label for="password_confirm">Confirm Password</label>
                    <input type="password" id="password_confirm" name="password_confirm" minlength="8" required>
                </div>
            </div>

            <h3 class="section-header">Shipping Address</h3>
            <p style="color: #666; font-size: 0.95rem; margin-bottom: 1rem;">Your official diploma will be shipped to this address.</p>

            <div class="form-group">
                <label for="address">Street Address</label>
                <input type="text" id="address" name="address" required>
            </div>

            <div class="form-grid">
                <div class="form-group">
                    <label for="city">City</label>
                    <input type="text" id="city" name="city" required>
                </div>
                <div class="form-group">
                    <label for="state">State</label>
                    <select id="state" name="state" required>
                        <option value="">Select State</option>
                        <option value="AL">Alabama</option>
                        <option value="AK">Alaska</option>
                        <option value="AZ">Arizona</option>
                        <option value="AR">Arkansas</option>
                        <option value="CA">California</option>
                        <option value="CO">Colorado</option>
                        <option value="CT">Connecticut</option>
                        <option value="DE">Delaware</option>
                        <option value="FL">Florida</option>
                        <option value="GA">Georgia</option>
                        <option value="HI">Hawaii</option>
                        <option value="ID">Idaho</option>
                        <option value="IL">Illinois</option>
                        <option value="IN">Indiana</option>
                        <option value="IA">Iowa</option>
                        <option value="KS">Kansas</option>
                        <option value="KY">Kentucky</option>
                        <option value="LA">Louisiana</option>
                        <option value="ME">Maine</option>
                        <option value="MD">Maryland</option>
                        <option value="MA">Massachusetts</option>
                        <option value="MI">Michigan</option>
                        <option value="MN">Minnesota</option>
                        <option value="MS">Mississippi</option>
                        <option value="MO">Missouri</option>
                        <option value="MT">Montana</option>
                        <option value="NE">Nebraska</option>
                        <option value="NV">Nevada</option>
                        <option value="NH">New Hampshire</option>
                        <option value="NJ">New Jersey</option>
                        <option value="NM">New Mexico</option>
                        <option value="NY">New York</option>
                        <option value="NC">North Carolina</option>
                        <option value="ND">North Dakota</option>
                        <option value="OH">Ohio</option>
                        <option value="OK">Oklahoma</option>
                        <option value="OR">Oregon</option>
                        <option value="PA">Pennsylvania</option>
                        <option value="RI">Rhode Island</option>
                        <option value="SC">South Carolina</option>
                        <option value="SD">South Dakota</option>
                        <option value="TN">Tennessee</option>
                        <option value="TX">Texas</option>
                        <option value="UT">Utah</option>
                        <option value="VT">Vermont</option>
                        <option value="VA">Virginia</option>
                        <option value="WA">Washington</option>
                        <option value="WV">West Virginia</option>
                        <option value="WI">Wisconsin</option>
                        <option value="WY">Wyoming</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="zip">ZIP Code</label>
                <input type="text" id="zip" name="zip" pattern="[0-9]{5}" maxlength="5" required>
            </div>

            <button type="submit" class="cta-button" style="width: 100%; padding: 15px;">Create Account & Continue</button>
        </form>
        
        <p class="form-footer-link">
            Already have an account? <a href="login.html">Login here</a>
        </p>
    </div>

    <footer>
        <div class="footer-links">
            <a href="about.html">About Us</a>
            <a href="gallery.html">Gallery</a>
            <a href="verify.html">Verify License</a>
            <a href="contact.html">Contact</a>
            <a href="privacy-policy.html">Privacy</a>
            <a href="terms.html">Terms</a>
        </div>
        <p class="disclaimer">
            <strong>Disclaimer:</strong> The Holistic Therapy Dog certification is commemorative and does not confer legal rights under the ADA.
        </p>
        <p>&copy; 2025 Holistic Therapy Dog Association. All Rights Reserved.</p>
    </footer>

    <script src="header.js"></script>
    <script src="footer.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('qualified') === 'yes') {
                document.getElementById('qualified-badge').style.display = 'block';
            }
        });

        const API_URL = 'https://api-signup.farberstyle.workers.dev';

        document.getElementById('signupForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const errorBox = document.getElementById('error-box');
            const btn = e.target.querySelector('button[type="submit"]');
            
            btn.disabled = true;
            btn.textContent = "Creating Account...";
            errorBox.style.display = 'none';

            const password = document.getElementById('password').value;
            const passwordConfirm = document.getElementById('password_confirm').value;

            if (password !== passwordConfirm) {
                errorBox.textContent = 'Passwords do not match.';
                errorBox.style.display = 'block';
                btn.disabled = false;
                btn.textContent = "Create Account & Continue";
                return;
            }

            if (password.length < 8) {
                errorBox.textContent = 'Password must be at least 8 characters long.';
                errorBox.style.display = 'block';
                btn.disabled = false;
                btn.textContent = "Create Account & Continue";
                return;
            }

            try {
                const formData = new FormData(document.getElementById('signupForm'));
                
                const response = await fetch(API_URL, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok && data.token) {
                    localStorage.setItem('session_token', data.token);
                    window.location.href = 'add-dog.html';
                } else {
                    errorBox.textContent = data.message || 'An error occurred. Please try again.';
                    errorBox.style.display = 'block';
                    btn.disabled = false;
                    btn.textContent = "Create Account & Continue";
                }
            } catch (error) {
                errorBox.textContent = 'Network error. Please try again.';
                errorBox.style.display = 'block';
                btn.disabled = false;
                btn.textContent = "Create Account & Continue";
            }
        });
    </script>
</body>
</html>